version: '3.9'

networks:
  default:
    name: golang-reference-project

services:
  app:
    image: ghcr.io/valentinlutz/golang-reference-project:latest
    container_name: app
    depends_on:
      - postgresql
      - wiremock
    volumes:
      - ../config/config.none-container.yaml:/app/config/config.yaml:ro
    ports:
      - '9080:8080'

  postgresql:
    image: postgres:14.2
    container_name: postgresql
    environment:
      POSTGRES_DB: dev_db
      POSTGRES_USER: test
      POSTGRES_PASSWORD: test
    ports:
      - '9432:5432'

  wiremock:
    image: wiremock/wiremock:2.33.2
    container_name: wiremock
    command: --no-request-journal --global-response-templating
    volumes:
      - ./wiremock/:/home/wiremock:ro
    ports:
      - '9081:8080'